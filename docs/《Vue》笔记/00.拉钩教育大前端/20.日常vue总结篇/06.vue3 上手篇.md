---
title: vue3 ä¸Šæ‰‹ç¯‡
date: 2023-06-18 17:04:38
permalink: /pages/5b69f2/
categories:
  - ã€ŠVueã€‹ç¬”è®°
  - æ‹‰é’©æ•™è‚²å¤§å‰ç«¯
  - æ—¥å¸¸vueæ€»ç»“ç¯‡
tags:
  - 
author: 
  name: citccld
  link: https://github.com/citccld
---
> [[ä¿å§†çº§] Vue3 å¼€å‘æ–‡æ¡£](https://juejin.cn/post/7220220100384407610)
>
> [Vue3.2 setupè¯­æ³•ç³–ã€Composition APIã€çŠ¶æ€åº“Piniaå½’çº³æ€»ç»“](https://juejin.cn/post/7006108454028836895)
>
> [èŠ±äº†ä¸€å¤©çš„æ—¶é—´ï¼Œåœ°æ¿å¼æ‰«ç›²äº†vue3æ‰€æœ‰APIç›²ç‚¹](https://juejin.cn/post/7164159759619194893)
>
> [vue3+setup+ts ğŸ”¥ï¼ˆä¸‡å­—æ€»ç»“ï¼‰](https://juejin.cn/post/7158331832512020511)

## ä¸€ã€æ–‡ä»¶ç»“æ„

Vue2ä¸­ï¼Œ`<template>` æ ‡ç­¾ä¸­åªèƒ½æœ‰ä¸€ä¸ªæ ¹å…ƒç´ ï¼Œåœ¨Vue3ä¸­æ²¡æœ‰æ­¤é™åˆ¶

```javascript
<template>
  // ...
</template>

<script setup>
  // ...
</script>

<style lang="scss" scoped>
  // æ”¯æŒCSSå˜é‡æ³¨å…¥v-bind(color)
</style>
```

## äºŒã€data

```javascript
<script setup>
  import { reactive, ref, toRefs } from 'vue'

  // refå£°æ˜å“åº”å¼æ•°æ®ï¼Œç”¨äºå£°æ˜åŸºæœ¬æ•°æ®ç±»å‹
  const name = ref('Jerry')
  // ä¿®æ”¹
  name.value = 'Tom'

  // reactiveå£°æ˜å“åº”å¼æ•°æ®ï¼Œç”¨äºå£°æ˜å¼•ç”¨æ•°æ®ç±»å‹
  const state = reactive({
    name: 'Jerry',
    sex: 'ç”·'
  })
  // ä¿®æ”¹
  state.name = 'Tom'
  
  // ä½¿ç”¨toRefsè§£æ„
  const {name, sex} = toRefs(state)
  // templateå¯ç›´æ¥ä½¿ç”¨{{name}}ã€{{sex}}
</script>
```

## ä¸‰ã€method

```javascript
<template>
  // è°ƒç”¨æ–¹æ³•
  <button @click='changeName'>æŒ‰é’®</button>  
</template>

<script setup>
  import { reactive } from 'vue'

  const state = reactive({
    name: 'Jery'
  })

  // å£°æ˜methodæ–¹æ³•
  const changeName = () => {
    state.name = 'Tom'
  }  
</script>
```

## å››ã€computed

```javascript
<script setup>
  import { computed, ref } from 'vue'

  const count = ref(1)

  // é€šè¿‡computedè·å¾—doubleCount
  const doubleCount = computed(() => {
    return count.value * 2
  })
  // è·å–
  console.log(doubleCount.value)
</script>
```

## äº”ã€watch

```javascript
<script setup>
  import { watch, reactive } from 'vue'

  const state = reactive({
    count: 1
  })

  // å£°æ˜æ–¹æ³•
  const changeCount = () => {
    state.count = state.count * 2
  }

  // ç›‘å¬count
  watch(
    () => state.count,
    (newVal, oldVal) => {
      console.log(state.count)
      console.log(`watchç›‘å¬å˜åŒ–å‰çš„æ•°æ®ï¼š${oldVal}`)
      console.log(`watchç›‘å¬å˜åŒ–åçš„æ•°æ®ï¼š${newVal}`)
    },
    {
      immediate: true, // ç«‹å³æ‰§è¡Œ
      deep: true // æ·±åº¦ç›‘å¬
    }
  )
</script>
```

## å…­ã€propsçˆ¶ä¼ å­

### å­ç»„ä»¶

```javascript
<template>
  <span>{{props.name}}</span>
  // å¯çœç•¥ã€props.ã€‘
  <span>{{name}}</span>
</template>

<script setup>
  // import { defineProps } from 'vue'
  // definePropsåœ¨<script setup>ä¸­è‡ªåŠ¨å¯ç”¨ï¼Œæ— éœ€å¯¼å…¥
  // éœ€åœ¨.eslintrc.jsæ–‡ä»¶ä¸­ã€globalsã€‘ä¸‹é…ç½®ã€defineProps: trueã€‘

  // å£°æ˜props
  const props = defineProps({
    name: {
      type: String,
      default: ''
    }
  })  
</script>
```

### çˆ¶ç»„ä»¶

å¼•å…¥å­ç»„ä»¶ï¼Œç»„ä»¶ä¼šè‡ªåŠ¨æ³¨å†Œ

```javascript
<template>
  <child name='Jerry'/>  
</template>

<script setup>
  // å¼•å…¥å­ç»„ä»¶
  import child from './child.vue'
</script>
```

## ä¸ƒã€emitå­ä¼ çˆ¶

### å­ç»„ä»¶

```javascript
<template>
  <span>{{props.name}}</span>
  // å¯çœç•¥ã€props.ã€‘
  <span>{{name}}</span>
  <button @click='changeName'>æ›´å</button>
</template>

<script setup>
  // import { defineEmits, defineProps } from 'vue'
  // defineEmitså’ŒdefinePropsåœ¨<script setup>ä¸­è‡ªåŠ¨å¯ç”¨ï¼Œæ— éœ€å¯¼å…¥
  // éœ€åœ¨.eslintrc.jsæ–‡ä»¶ä¸­ã€globalsã€‘ä¸‹é…ç½®ã€defineEmits: trueã€‘ã€ã€defineProps: trueã€‘
	
  // å£°æ˜props
  const props = defineProps({
    name: {
      type: String,
      default: ''
    }
  }) 
  // å£°æ˜äº‹ä»¶
  const emit = defineEmits(['updateName'])
  
  const changeName = () => {
    // æ‰§è¡Œ
    emit('updateName', 'Tom')
  }
</script>
```

### çˆ¶ç»„ä»¶

```javascript
<template>
  <child :name='state.name' @updateName='updateName'/>  
</template>

<script setup>
  import { reactive } from 'vue'
  // å¼•å…¥å­ç»„ä»¶
  import child from './child.vue'

  const state = reactive({
    name: 'Jerry'
  })
  
  // æ¥æ”¶å­ç»„ä»¶è§¦å‘çš„æ–¹æ³•
  const updateName = (name) => {
    state.name = name
  }
</script>
```

## å…«ã€v-model

æ”¯æŒç»‘å®šå¤šä¸ª`v-model`ï¼Œ`v-model` æ˜¯ `v-model:modelValue` çš„ç®€å†™ 
 ç»‘å®šå…¶ä»–å­—æ®µï¼Œå¦‚ï¼š`v-model:name`

### å­ç»„ä»¶

```javascript
<template>
  <span @click="changeInfo">æˆ‘å«{{ modelValue }}ï¼Œä»Šå¹´{{ age }}å²</span>
</template>

<script setup>
  // import { defineEmits, defineProps } from 'vue'
  // defineEmitså’ŒdefinePropsåœ¨<script setup>ä¸­è‡ªåŠ¨å¯ç”¨ï¼Œæ— éœ€å¯¼å…¥
  // éœ€åœ¨.eslintrc.jsæ–‡ä»¶ä¸­ã€globalsã€‘ä¸‹é…ç½®ã€defineEmits: trueã€‘ã€ã€defineProps: trueã€‘

  defineProps({
    modelValue: String,
    age: Number
  })

  const emit = defineEmits(['update:modelValue', 'update:age'])
  const changeInfo = () => {
    // è§¦å‘çˆ¶ç»„ä»¶å€¼æ›´æ–°
    emit('update:modelValue', 'Tom')
    emit('update:age', 30)
  }
</script>
```

### çˆ¶ç»„ä»¶

```javascript
<template>
  // v-model:modelValueç®€å†™ä¸ºv-model
  // å¯ç»‘å®šå¤šä¸ªv-model
  <child
    v-model="state.name"
    v-model:age="state.age"
  />
</template>

<script setup>
  import { reactive } from 'vue'
  // å¼•å…¥å­ç»„ä»¶
  import child from './child.vue'

  const state = reactive({
    name: 'Jerry',
    age: 20
  })
</script>
```

## ä¹ã€nextTick

```javascript
<script setup>
  import { nextTick } from 'vue'
	
  nextTick(() => {
    // ...
  })
</script>
```

## åã€refå­ç»„ä»¶å®ä¾‹å’ŒdefineExpose

- åœ¨æ ‡å‡†ç»„ä»¶å†™æ³•é‡Œï¼Œå­ç»„ä»¶çš„æ•°æ®éƒ½æ˜¯é»˜è®¤éšå¼æš´éœ²ç»™çˆ¶ç»„ä»¶çš„ï¼Œä½†åœ¨ script-setup æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰æ•°æ®åªæ˜¯é»˜è®¤ return ç»™ template ä½¿ç”¨ï¼Œä¸ä¼šæš´éœ²åˆ°ç»„ä»¶å¤–ï¼Œæ‰€ä»¥çˆ¶ç»„ä»¶æ˜¯æ— æ³•ç›´æ¥é€šè¿‡æŒ‚è½½ ref å˜é‡è·å–å­ç»„ä»¶çš„æ•°æ®ã€‚
- å¦‚æœè¦è°ƒç”¨å­ç»„ä»¶çš„æ•°æ®ï¼Œéœ€è¦å…ˆåœ¨å­ç»„ä»¶æ˜¾ç¤ºçš„æš´éœ²å‡ºæ¥ï¼Œæ‰èƒ½å¤Ÿæ­£ç¡®çš„æ‹¿åˆ°ï¼Œè¿™ä¸ªæ“ä½œï¼Œå°±æ˜¯ç”± defineExpose æ¥å®Œæˆã€‚

### å­ç»„ä»¶

```javascript
<template>
  <span>{{state.name}}</span>
</template>

<script setup>
  import { reactive, toRefs } from 'vue'
  // defineExposeæ— éœ€å¼•å…¥
  // import { defineExpose, reactive, toRefs } from 'vue'

  // å£°æ˜state
  const state = reactive({
    name: 'Jerry'
  }) 
	
  // å°†æ–¹æ³•ã€å˜é‡æš´éœ²ç»™çˆ¶ç»„ä»¶ä½¿ç”¨ï¼Œçˆ¶ç»„ä»¶æ‰å¯é€šè¿‡ref APIæ‹¿åˆ°å­ç»„ä»¶æš´éœ²çš„æ•°æ®
  defineExpose({
    // è§£æ„state
    ...toRefs(state),
    // å£°æ˜æ–¹æ³•
    changeName () {
      state.name = 'Tom'
    }
  })
</script>
```

### çˆ¶ç»„ä»¶

#### 1. è·å–ä¸€ä¸ªå­ç»„ä»¶å®ä¾‹

```typescript
<template>
  <child ref='childRef'/>
</template>

<script setup>
  import { ref, nextTick } from 'vue'
  // å¼•å…¥å­ç»„ä»¶
  import child from './child.vue'

  // å­ç»„ä»¶refï¼ˆTypeScriptè¯­æ³•ï¼‰
  const childRef = ref<InstanceType<typeof child>>()
  
  // nextTick
  nextTick(() => {
    // è·å–å­ç»„ä»¶name
    console.log(childRef.value.name)
    // æ‰§è¡Œå­ç»„ä»¶æ–¹æ³•
    childRef.value.changeName()
  })
</script>
```

#### 2. è·å–å¤šä¸ªå­ç»„ä»¶å®ä¾‹ï¼šåœ¨ v-for ä¸­è·å–å­ç»„ä»¶å®ä¾‹

è¿™ç§æƒ…å†µä»…é€‚ç”¨äº v-for `å¾ªç¯æ•°æ˜¯å›ºå®šçš„æƒ…å†µ` ï¼Œå› ä¸ºå¦‚æœ v-for `å¾ªç¯æ•°` åœ¨åˆå§‹åŒ–ä¹‹åå‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´ childRefs å†ä¸€æ¬¡é‡å¤æ·»åŠ ï¼ŒchildRefs ä¸­ä¼šå‡ºç°é‡å¤çš„å­ç»„ä»¶å®ä¾‹

```typescript
<template>
  <div v-for="item in 3" :key="item">
    <child :ref='addChildRef'/>
  </div>
</template>

<script setup>
  // çœç•¥...
  
  // å­ç»„ä»¶å®ä¾‹æ•°ç»„
  const childRefs = ref([])
  // é€šè¿‡ addChildRef æ–¹æ³•å‘ childRefs æ·»åŠ å­ç»„ä»¶å®ä¾‹
  const addChildRef = (el) => {
    childRefs.value.push(el)
  }
</script>
```

#### 3. è·å–å¤šä¸ªå­ç»„ä»¶å®ä¾‹ï¼šåŠ¨æ€ v-for è·å–å­ç»„ä»¶å®ä¾‹

é€šè¿‡ä¸‹æ ‡æ¥å‘ childRefs æ·»åŠ /ä¿®æ”¹ï¼Œåˆå§‹åŒ–ä¹‹åï¼ŒåŠ¨æ€ä¿®æ”¹ v-for å¾ªç¯æ•°ï¼Œä¼šè‡ªåŠ¨æ ¹æ®ä¸‹æ ‡é‡æ–°ä¿®æ”¹è¯¥ä¸‹æ ‡å¯¹åº”çš„æ•°æ®

```typescript
<template>
  <button @click='childNums++'></button>
  <div v-for="(item, i) in childNums" :key="item">
    // é€šè¿‡ä¸‹æ ‡å‘ childRefs åŠ¨æ€æ·»åŠ å­ç»„ä»¶å®ä¾‹
    <child :ref='(el) => childRefs[i] = el'/>
  </div>
  <button @click='childNums--'></button>
</template>

<script setup>
  // çœç•¥...
  
  // å­ç»„ä»¶æ•°é‡
  const childNums = ref(1)
  // å­ç»„ä»¶å®ä¾‹æ•°ç»„
  const childRefs = ref([])
</script>
```

## åã€æ’æ§½slot

### å­ç»„ä»¶

```javascript
<template>
  // åŒ¿åæ’æ§½
  <slot/>
  // å…·åæ’æ§½
  <slot name='title'/>
  // ä½œç”¨åŸŸæ’æ§½
  <slot name="footer" :scope="state" />
</template>

<script setup>
  import { useSlots, reactive } from 'vue'
  const state = reactive({
    name: 'å¼ ä¸‰',
    age: '25å²'
  })
  
  const slots = useSlots()
  // åŒ¿åæ’æ§½ä½¿ç”¨æƒ…å†µ
  const defaultSlot = reactive(slots.default && slots.default().length)
  console.log(defaultSlot) // 1
  // å…·åæ’æ§½ä½¿ç”¨æƒ…å†µ
  const titleSlot = reactive(slots.title && slots.title().length)
  console.log(titleSlot) // 3
</script>
```

### çˆ¶ç»„ä»¶

```javascript
<template>
  <child>
    // åŒ¿åæ’æ§½
    <span>æˆ‘æ˜¯é»˜è®¤æ’æ§½</span>
    // å…·åæ’æ§½
    <template #title>
      <h1>æˆ‘æ˜¯å…·åæ’æ§½</h1>
      <h1>æˆ‘æ˜¯å…·åæ’æ§½</h1>
      <h1>æˆ‘æ˜¯å…·åæ’æ§½</h1>
    </template>
    // ä½œç”¨åŸŸæ’æ§½
    <template #footer="{ scope }">
      <footer>ä½œç”¨åŸŸæ’æ§½â€”â€”å§“åï¼š{{ scope.name }}ï¼Œå¹´é¾„{{ scope.age }}</footer>
    </template>
  </child> 
</template>

<script setup>
  // å¼•å…¥å­ç»„ä»¶
  import child from './child.vue'
</script>
```

## åäºŒã€è·¯ç”±useRouteå’ŒuseRouter

```javascript
<script setup>
  import { useRoute, useRouter } from 'vue-router'
	
  // å¿…é¡»å…ˆå£°æ˜è°ƒç”¨
  const route = useRoute()
  const router = useRouter()
	
  // è·¯ç”±ä¿¡æ¯
  console.log(route.query)

  // è·¯ç”±è·³è½¬
  router.push('/newPage')
</script>
```

## åä¸‰ã€è·¯ç”±å¯¼èˆªå®ˆå«

```javascript
<script setup>
  import { onBeforeRouteLeave, onBeforeRouteUpdate } from 'vue-router'
	
  // æ·»åŠ ä¸€ä¸ªå¯¼èˆªå®ˆå«ï¼Œåœ¨å½“å‰ç»„ä»¶å°†è¦ç¦»å¼€æ—¶è§¦å‘ã€‚
  onBeforeRouteLeave((to, from, next) => {
    next()
  })

  // æ·»åŠ ä¸€ä¸ªå¯¼èˆªå®ˆå«ï¼Œåœ¨å½“å‰ç»„ä»¶æ›´æ–°æ—¶è§¦å‘ã€‚
  // åœ¨å½“å‰è·¯ç”±æ”¹å˜ï¼Œä½†æ˜¯è¯¥ç»„ä»¶è¢«å¤ç”¨æ—¶è°ƒç”¨ã€‚
  onBeforeRouteUpdate((to, from, next) => {
    next()
  })
</script>
```

## åå››ã€store

### Vuex

*Vue3 ä¸­çš„Vuexä¸å†æä¾›è¾…åŠ©å‡½æ•°å†™æ³•

```javascript
<script setup>
  import { useStore } from 'vuex'
  import { key } from '../store/index'

  // å¿…é¡»å…ˆå£°æ˜è°ƒç”¨
  const store = useStore(key)
	
  // è·å–Vuexçš„state
  store.state.xxx

  // è§¦å‘actionsçš„æ–¹æ³•
  store.commit('fnName')

  // è§¦å‘actionsçš„æ–¹æ³•
  store.dispatch('fnName')

  // è·å–Getters
  store.getters.xxx
</script>
```

### Pinia

*å…¨é¢æ‹¥æŠ± `Pinia` å§ï¼ 
 2021å¹´11æœˆ24æ—¥ï¼Œå°¤å¤§åœ¨ Twitter ä¸Šå®£å¸ƒï¼š`Pinia` æ­£å¼æˆä¸º Vue å®˜æ–¹çš„çŠ¶æ€åº“ï¼Œæ„å‘³ç€ `Pinia` å°±æ˜¯ `Vuex 5` ï¼Œ`Pinia` çš„ä¼˜ç‚¹ï¼š 

- åŒæ—¶æ”¯æŒ Composition Api å’Œ Options api çš„è¯­æ³•ï¼›
- å»æ‰ mutations ï¼Œåªæœ‰ state ã€getters å’Œ actions ï¼›
- ä¸æ”¯æŒåµŒå¥—çš„æ¨¡å—ï¼Œé€šè¿‡ç»„åˆ store æ¥ä»£æ›¿ï¼›
- æ›´å®Œå–„çš„ Typescript æ”¯æŒï¼›
- æ¸…æ™°ã€æ˜¾å¼çš„ä»£ç æ‹†åˆ†ï¼›

#### å®‰è£…

```javascript
# ä½¿ç”¨ npm
npm install pinia

# ä½¿ç”¨ yarn
yarn add pinia
```

#### main.js å¼•å…¥

```javascript
import App from './App.vue'
import { createApp } from 'vue'
import { createPinia } from 'pinia'

const app = createApp(App)
app.use(createPinia())
app.mount('#app')
```

#### é…ç½® store.js

```javascript
import { defineStore } from 'pinia'

// defineStore è°ƒç”¨åè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè°ƒç”¨è¯¥å‡½æ•°è·å¾— Store å®ä½“
export const useStore = defineStore({
  // id: å¿…é¡»ï¼Œåœ¨æ‰€æœ‰ Store ä¸­å”¯ä¸€
  id: 'globalState',
  // state: è¿”å›å¯¹è±¡çš„å‡½æ•°
  state: () => ({
    count: 1,
    data: {
      name: 'Jerry',
      sex: 'ç”·'
    }
  }),
  // getter ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ stateï¼Œæ˜¯å½“å‰çš„çŠ¶æ€ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ this è·å–çŠ¶æ€
  // getter ä¸­ä¹Ÿå¯ä»¥è®¿é—®å…¶ä»–çš„ getterï¼Œæˆ–è€…æ˜¯å…¶ä»–çš„ Store
  getters: {
    // é€šè¿‡ state è·å–çŠ¶æ€
    doubleCount: (state) => state.count * 2,
    // é€šè¿‡ this è·å–çŠ¶æ€ï¼ˆæ³¨æ„thisæŒ‡å‘ï¼‰
    tripleCount() {
      return this.count * 3
    }
  },
  actions: {
    updateData (newData, count) {
      // ä½¿ç”¨ this ç›´æ¥ä¿®æ”¹
      this.data = { ...newData }
      this.count = count
      
      // ä½¿ç”¨ $patch ä¿®æ”¹å¤šä¸ªå€¼
      this.$patch({
        data: { ...newData },
        count
      })
    }
  }
})
```

#### ä½¿ç”¨ store

```javascript
<template>
  // è·å– store çš„ state
  <p>å§“åï¼š{{store.data.name}}</p>
  <p>æ€§åˆ«ï¼š{{store.data.sex}}</p>
  
  // è°ƒç”¨ actions æ–¹æ³• / ä¿®æ”¹ store
  <button @click='update'>ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯</button>
  
  // è·å– getter
  <p>è·å–getterï¼š{{store.doubleCount}}</p>
</template>

<script setup>
  import { useStore } from '@store/store.js'
  const store = useStore()
  
  function update () {
    // é€šè¿‡ actions å®šä¹‰çš„æ–¹æ³•ä¿®æ”¹ state
    store.updateData({ name: 'Tom', sex: 'å¥³' })
    
    // é€šè¿‡ store ç›´æ¥ä¿®æ”¹
    store.data = { name: 'Tom', sex: 'å¥³' }
    
    // åŒæ—¶æ”¹å˜å¤šä¸ªçŠ¶æ€
    store.$patch((state) => {
      state.data = { name: 'Tom', sex: 'å¥³' }
      state.count = 2
    })
  }
</script>

<style lang="scss" scoped>
</style>
```

#### å…¶ä»–æ–¹æ³•

**æ›¿æ¢æ•´ä¸ª state** 
 `$state` å¯ä»¥è®©ä½ é€šè¿‡å°† `store` çš„å±æ€§è®¾ç½®ä¸ºæ–°å¯¹è±¡æ¥æ›¿æ¢ `store` çš„æ•´ä¸ª `state`

```javascript
const store = useStore()
store.$state = {
  name: 'Bob',
  sex: 'ç”·'
}
```

**é‡ç½®çŠ¶æ€** 
 è°ƒç”¨ `store` ä¸Šçš„ `$reset()` æ–¹æ³•å°†çŠ¶æ€é‡ç½®ä¸ºåˆå§‹å€¼

```javascript
const store = useStore()
store.$reset()
```

## åäº”ã€ç”Ÿå‘½å‘¨æœŸ

é€šè¿‡åœ¨ç”Ÿå‘½å‘¨æœŸé’©å­å‰é¢åŠ ä¸Š â€œonâ€ æ¥è®¿é—®ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸé’©å­ã€‚

ä¸‹è¡¨åŒ…å«å¦‚ä½•åœ¨ Option API å’Œ setup() å†…éƒ¨è°ƒç”¨ç”Ÿå‘½å‘¨æœŸé’©å­

| **Option API**  | **setupä¸­**       |
| --------------- | ----------------- |
| beforeCreate    | ä¸éœ€è¦            |
| created         | ä¸éœ€è¦            |
| beforeMount     | onBeforeMount     |
| mounted         | onMounted         |
| beforeUpdate    | onBeforeUpdate    |
| updated         | onUpdated         |
| beforeUnmount   | onBeforeUnmount   |
| unmounted       | onUnmounted       |
| errorCaptured   | onErrorCaptured   |
| renderTracked   | onRenderTracked   |
| renderTriggered | onRenderTriggered |
| activated       | onActivated       |
| deactivated     | onDeactivated     |

## åå…­ã€åŸå‹ç»‘å®šä¸ç»„ä»¶å†…ä½¿ç”¨

### main.js

```javascript
import { createApp } from 'vue'
import App from './App.vue'
const app = createApp(App)

// è·å–åŸå‹
const prototype = app.config.globalProperties

// ç»‘å®šå‚æ•°
prototype.name = 'Jerry'
```

### ç»„ä»¶å†…ä½¿ç”¨

```javascript
<script setup>
  import { getCurrentInstance } from 'vue'

  // è·å–åŸå‹
  const { proxy } = getCurrentInstance()
  
  // è¾“å‡º
  console.log(proxy.name)
</script>
```

## åä¸ƒã€v-bind() CSSå˜é‡æ³¨å…¥

```javascript
<template>
  <span>Jerry</span>
</template>

<script setup>
  import { ref, reactive } from 'vue'
  // propæ¥æ”¶æ ·å¼
  const props = defineProps({
    border: {
      type: String,
      default: '1px solid yellow'
    }
  })
  
  // å¸¸é‡å£°æ˜æ ·å¼
  const background = 'red'
  
  // å“åº”å¼æ•°æ®å£°æ˜æ ·å¼
  const color = ref('blue')
  const style = reactive({
    opacity: '0.8'
  })
</script>

<style lang="scss" scoped>
  span {
    // ä½¿ç”¨å¸¸é‡å£°æ˜çš„æ ·å¼
    background: v-bind(background);
    
    // ä½¿ç”¨å“åº”å¼æ•°æ®å£°æ˜çš„æ ·å¼
    color: v-bind(color);
    opacity: v-bind('style.opacity');
    
    // ä½¿ç”¨propæ¥æ”¶çš„æ ·å¼
    border: v-bind('props.border');
  }
</style>
```

## åå…«ã€provideå’Œinject

### çˆ¶ç»„ä»¶

```javascript
<template>
  <child/>
</template>

<script setup>
  import { ref, watch, provide } from 'vue'
  // å¼•å…¥å­ç»„ä»¶
  import child from './child.vue'

  let name = ref('Jerry')
  // å£°æ˜provide
  provide('provideState', {
    name,
    changeName: () => {
      name.value = 'Tom'
    }
  })

  // ç›‘å¬nameæ”¹å˜
  watch(name, () => {
    console.log(`nameå˜æˆäº†${name}`)
    setTimeout(() => {
      console.log(name.value) // Tom
    }, 1000)
  })
</script>
```

### å­ç»„ä»¶

```javascript
<script setup>
  import { inject } from 'vue'
  // æ³¨å…¥ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºé»˜è®¤å€¼
  const provideState = inject('provideState', {})
  
  // å­ç»„ä»¶è§¦å‘nameæ”¹å˜
  provideState.changeName()
</script>
```

## åä¹ã€è‡ªå®šä¹‰æŒ‡ä»¤

Vue3ç›¸è¾ƒäºVue2çš„è‡ªå®šä¹‰å£°æ˜æ–¹æ³•æœ‰äº›ä¸åŒ

```javascript
const app = createApp({})

// ä½¿ v-demo åœ¨æ‰€æœ‰ç»„ä»¶ä¸­éƒ½å¯ç”¨
app.directive('demo', {
  // åœ¨ç»‘å®šå…ƒç´ çš„ attribute å‰æˆ–äº‹ä»¶ç›‘å¬å™¨åº”ç”¨å‰è°ƒç”¨
  created(el, binding, vnode, prevVnode) {},
  // åœ¨å…ƒç´ è¢«æ’å…¥åˆ° DOM å‰è°ƒç”¨
  beforeMount(el, binding, vnode, prevVnode) {},
  // åœ¨ç»‘å®šå…ƒç´ çš„çˆ¶ç»„ä»¶
  // åŠä»–è‡ªå·±çš„æ‰€æœ‰å­èŠ‚ç‚¹éƒ½æŒ‚è½½å®Œæˆåè°ƒç”¨
  mounted(el, binding, vnode, prevVnode) {},
  // ç»‘å®šå…ƒç´ çš„çˆ¶ç»„ä»¶æ›´æ–°å‰è°ƒç”¨
  beforeUpdate(el, binding, vnode, prevVnode) {},
  // åœ¨ç»‘å®šå…ƒç´ çš„çˆ¶ç»„ä»¶
  // åŠä»–è‡ªå·±çš„æ‰€æœ‰å­èŠ‚ç‚¹éƒ½æ›´æ–°åè°ƒç”¨
  updated(el, binding, vnode, prevVnode) {},
  // ç»‘å®šå…ƒç´ çš„çˆ¶ç»„ä»¶å¸è½½å‰è°ƒç”¨
  beforeUnmount(el, binding, vnode, prevVnode) {},
  // ç»‘å®šå…ƒç´ çš„çˆ¶ç»„ä»¶å¸è½½åè°ƒç”¨
  unmounted(el, binding, vnode, prevVnode) {}
})
```

æ¯”å¦‚å®ç°ä¸€ä¸ªé»˜è®¤å¯†æ–‡èº«ä»½è¯å·ï¼Œç‚¹å‡»æ‰å±•ç¤ºçš„æŒ‡ä»¤

```javascript
app.directive('ciphertext', {
  created: (el: any) => {
    console.log(el, 1111)
    el.style.cursor = 'pointer'
    const value = el.innerText
    if (!value || value === 'null' || value === '--') {
      el.innerText = '--'
    } else {
      el.setAttribute('title', 'ç‚¹å‡»æŸ¥çœ‹')
      el.innerText = hideText(value)
      el.addEventListener('click', () => {
        if (el.innerText.indexOf('*') > -1) {
          el.innerText = value
        } else {
          el.innerText = hideText(value)
        }
      })
    }
  }
})

<span v-ciphertext>{{idNumber}}</span>
```

## äºŒåã€å¯¹ await çš„æ”¯æŒ

ä¸å¿…å†é…åˆ async å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ await äº†ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œç»„ä»¶çš„ setup ä¼šè‡ªåŠ¨å˜æˆ async setup ã€‚

```javascript
<script setup>
  const post = await fetch('/api').then(() => {})
</script>
```

## äºŒåä¸€ã€å®šä¹‰ç»„ä»¶çš„name

ç”¨å•ç‹¬çš„`<script>`å—æ¥å®šä¹‰

```javascript
<script>
  export default {
    name: 'ComponentName',
  }
</script>
```

æ›´ä¼˜é›…çš„æ–¹å¼ï¼Œå®‰è£…æ’ä»¶ï¼š`vite-plugin-vue-setup-extend`ï¼Œå°±å¯ä»¥æŒ‰ä»¥ä¸‹æ–¹å¼å®šä¹‰nameäº†

#### é…ç½® `vite.config.ts`

```javascript
import { defineConfig } from 'vite'
import VueSetupExtend from 'vite-plugin-vue-setup-extend'
export default defineConfig({
  plugins: [VueSetupExtend()]
})
```

#### ä½¿ç”¨

```javascript
<script setup name="ComponentName">
  // todo
</script>
```

## äºŒåä¸‰ã€Vue3 çš„ script setup è¯­æ³•ç³–

### script setup æ˜¯ä¸ªå•¥ï¼Ÿ

å®ƒæ˜¯ Vue3 çš„ä¸€ä¸ªæ–°è¯­æ³•ç³–ï¼Œåœ¨ `setup` å‡½æ•°ä¸­ã€‚æ‰€æœ‰ ES æ¨¡å—å¯¼å‡ºéƒ½è¢«è®¤ä¸ºæ˜¯æš´éœ²ç»™ä¸Šä¸‹æ–‡çš„å€¼ï¼Œå¹¶åŒ…å«åœ¨ setup() è¿”å›å¯¹è±¡ä¸­ã€‚ç›¸å¯¹äºä¹‹å‰çš„å†™æ³•ï¼Œä½¿ç”¨åï¼Œè¯­æ³•ä¹Ÿå˜å¾—æ›´ç®€å•ã€‚

ä½¿ç”¨æ–¹å¼æå…¶ç®€å•ï¼Œä»…éœ€è¦åœ¨ `script` æ ‡ç­¾åŠ ä¸Š `setup` å…³é”®å­—å³å¯ã€‚ç¤ºä¾‹ï¼š

```js
<script setup></script>
```

### ç»„ä»¶è‡ªåŠ¨æ³¨å†Œ

åœ¨ script setup ä¸­ï¼Œå¼•å…¥çš„ç»„ä»¶å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œæ— éœ€å†é€šè¿‡`components`è¿›è¡Œæ³¨å†Œï¼Œå¹¶ä¸”æ— æ³•æŒ‡å®šå½“å‰ç»„ä»¶çš„åå­—ï¼Œå®ƒä¼šè‡ªåŠ¨ä»¥æ–‡ä»¶åä¸ºä¸»ï¼Œä¹Ÿå°±æ˜¯ä¸ç”¨å†å†™`name`å±æ€§äº†ã€‚ç¤ºä¾‹ï¼š

```js
<template>
    <Child />
</template>

<script setup>
import Child from './Child.vue'
</script>
```

å¦‚æœéœ€è¦å®šä¹‰ç±»ä¼¼ name çš„å±æ€§ï¼Œå¯ä»¥å†åŠ ä¸ªå¹³çº§çš„ script æ ‡ç­¾ï¼Œåœ¨é‡Œé¢å®ç°å³å¯ã€‚

### ç»„ä»¶æ ¸å¿ƒ API çš„ä½¿ç”¨

#### ä½¿ç”¨ props

é€šè¿‡`defineProps`æŒ‡å®šå½“å‰ props ç±»å‹ï¼Œè·å¾—ä¸Šä¸‹æ–‡çš„propså¯¹è±¡ã€‚ç¤ºä¾‹ï¼š

```js
<script setup>
  import { defineProps } from 'vue'

  const props = defineProps({
    title: String,
  })
</script>
```

#### ä½¿ç”¨ emits

ä½¿ç”¨`defineEmit`å®šä¹‰å½“å‰ç»„ä»¶å«æœ‰çš„äº‹ä»¶ï¼Œå¹¶é€šè¿‡è¿”å›çš„ä¸Šä¸‹æ–‡å»æ‰§è¡Œ emitã€‚ç¤ºä¾‹ï¼š

```js
<script setup>
  import { defineEmits } from 'vue'

  const emit = defineEmits(['change', 'delete'])
</script>
```

#### è·å– slots å’Œ attrs

å¯ä»¥é€šè¿‡`useContext`ä»ä¸Šä¸‹æ–‡ä¸­è·å– slots å’Œ attrsã€‚ä¸è¿‡ææ¡ˆåœ¨æ­£å¼é€šè¿‡åï¼ŒåºŸé™¤äº†è¿™ä¸ªè¯­æ³•ï¼Œè¢«æ‹†åˆ†æˆäº†`useAttrs`å’Œ`useSlots`ã€‚ç¤ºä¾‹ï¼š

```js
// æ—§
<script setup>
  import { useContext } from 'vue'

  const { slots, attrs } = useContext()
</script>

// æ–°
<script setup>
  import { useAttrs, useSlots } from 'vue'

  const attrs = useAttrs()
  const slots = useSlots()
</script>
```

### defineExpose API

ä¼ ç»Ÿçš„å†™æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨çˆ¶ç»„ä»¶ä¸­ï¼Œé€šè¿‡ ref å®ä¾‹çš„æ–¹å¼å»è®¿é—®å­ç»„ä»¶çš„å†…å®¹ï¼Œä½†åœ¨ script setup ä¸­ï¼Œè¯¥æ–¹æ³•å°±ä¸èƒ½ç”¨äº†ï¼Œsetup ç›¸å½“äºæ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œé™¤äº†å†…éƒ¨çš„ `template`æ¨¡æ¿ï¼Œè°éƒ½ä¸èƒ½è®¿é—®å†…éƒ¨çš„æ•°æ®å’Œæ–¹æ³•ã€‚

å¦‚æœéœ€è¦å¯¹å¤–æš´éœ² setup ä¸­çš„æ•°æ®å’Œæ–¹æ³•ï¼Œéœ€è¦ä½¿ç”¨ defineExpose APIã€‚ç¤ºä¾‹ï¼š

```xml
<script setup>
	import { defineExpose } from 'vue'
	const a = 1
	const b = 2
	defineExpose({
	    a
	})
</script>
```

#### å±æ€§å’Œæ–¹æ³•æ— éœ€è¿”å›ï¼Œç›´æ¥ä½¿ç”¨ï¼

è¿™å¯èƒ½æ˜¯å¸¦æ¥çš„è¾ƒå¤§ä¾¿åˆ©ä¹‹ä¸€ï¼Œåœ¨ä»¥å¾€çš„å†™æ³•ä¸­ï¼Œå®šä¹‰æ•°æ®å’Œæ–¹æ³•ï¼Œéƒ½éœ€è¦åœ¨ç»“å°¾ return å‡ºå»ï¼Œæ‰èƒ½åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ã€‚åœ¨ script setup ä¸­ï¼Œå®šä¹‰çš„å±æ€§å’Œæ–¹æ³•æ— éœ€è¿”å›ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼ç¤ºä¾‹ï¼š

```js
<template>
  <div>
   	<p>My name is {{name}}</p>
  </div>
</template>

<script setup>
import { ref } from 'vue';

const name = ref('Sam')
</script>
```

## äºŒåå››ã€5ä¸ªç»´åº¦æ¥è®²Vue3

### 1ã€æ¡†æ¶

#### å¼‚æ­¥ç»„ä»¶ï¼ˆdefineAsyncComponentï¼‰

æˆ‘ä»¬éƒ½çŸ¥é“åœ¨ Vue2 ä¹Ÿæœ‰å¼‚æ­¥ç»„ä»¶çš„æ¦‚å¿µï¼Œä½†æ•´ä½“ä¸Šæ¥è¯´ä¸ç®—å®Œæ•´~ï¼ŒVue3 æä¾›äº† `defineAsyncComponent` æ–¹æ³•ä¸ `Suspense` å†…ç½®ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒä»¬æ¥åšä¸€ä¸ªä¼˜é›…çš„å¼‚æ­¥ç»„ä»¶åŠ è½½æ–¹æ¡ˆã€‚

ç›´æ¥çœ‹ä»£ç ï¼š

HOCLazy/index.tsx

```JavaScript
import { defineAsyncComponent, defineComponent } from 'vue';
import MySuspense from './MySuspense.vue';
export default function HOCLazy(chunk: any, isComponent: boolean = false) {
  const wrappedComponent = defineAsyncComponent(chunk);
  return defineComponent({
    name: 'HOCLazy',
    setup() {
      const props = { isComponent, wrappedComponent };
      return () => <MySuspense {...props} />;
    }
  });
}
```

è§£é‡Šï¼šHOCLazy æ¥æ”¶äº†ä¸¤ä¸ªå‚æ•°ï¼Œ`chunk` å°±æ˜¯æˆ‘ä»¬ç»å¸¸é‡‡ç”¨çš„ç»„ä»¶å¼‚æ­¥åŠ è½½æ–¹å¼å¦‚ï¼š`chunk=()=>import(xxx.vue)`ï¼Œ`isComponent` è¡¨ç¤ºå½“å‰çš„â€œç»„ä»¶â€æ˜¯ä¸€ä¸ª ç»„ä»¶çº§ or é¡µé¢çº§ï¼Œé€šè¿‡åˆ¤æ–­ `isComponent` æ¥åˆ†åˆ«å¯¹åº”ä¸åŒçš„ â€œloadingâ€ æ“ä½œã€‚

HOCLazy/MySuspense.vue

```html
<template>
  <Suspense>
    <template #default>
      <component :is="wrappedComponent"
                 v-bind="$attrs" />
    </template>
    <template #fallback>
      <div>
        <Teleport to="body"
                  :disabled="isComponent">
          <div v-if="delayShow"
               class="loading"
               :class="{component:isComponent}">
            <!-- ç»„ä»¶å’Œé¡µé¢æœ‰ä¸¤ç§ä¸ä¸€æ ·çš„loadingæ–¹å¼ï¼Œè¿™é‡Œä¸å†è¯¦ç»†å°è£… -->
            <div> {{isComponent?'ç»„ä»¶çº§':'é¡µé¢çº§'}}Loading ...</div>
          </div>
        </Teleport>
      </div>
    </template>
  </Suspense>
</template>

<script lang="ts">
import { defineComponent, defineAsyncComponent, ref, onMounted } from 'vue';
export default defineComponent({
  name: 'HOCLazy',
  props: ['isComponent', 'wrappedComponent'],
  setup(props) {
    const delayShow = ref<boolean>(false);
    onMounted(() => {
      setTimeout(() => {
        delayShow.value = true;
        // delay è‡ªå·±æ‹¿æï¼Œä¹Ÿå¯ä»¥ä»¥ props çš„æ–¹å¼ä¼ å…¥
      }, 300);
    });
    return { ...props, delayShow };
  }
});
</script>

<style lang="less" scoped>
.loading {
  // ç»„ä»¶çº§æ ·å¼
  &.component {
  }
  // é¡µé¢çº§æ ·å¼
}
</style>
```

è§£é‡Šï¼š

1. Suspense ç»„ä»¶æœ‰ä¸¤ä¸ªæ’æ§½ï¼Œå…·åæ’æ§½ `fallback` æˆ‘ä»¬è¿™é‡Œå¯ä»¥ç†è§£æˆä¸€ä¸ª loading çš„å ä½ç¬¦ï¼Œåœ¨å¼‚æ­¥ç»„ä»¶è¿˜æ²¡æ˜¾ç¤ºä¹‹å‰çš„åå¤‡å†…å®¹ã€‚
2. è¿™é‡Œè¿˜ç”¨äº† Vue çš„åŠ¨æ€ç»„ä»¶ component æ¥çµæ´»çš„ä¼ å…¥ä¸€ä¸ªå¼‚æ­¥ç»„ä»¶ï¼Œ`v-bind="$attrs"` æ¥ä¿è¯æˆ‘ä»¬ä¼ é€’ç»™ç›®æ ‡ç»„ä»¶çš„ props ä¸ä¼šæ¶ˆå¤±ã€‚
3. fallback ä¸­æˆ‘ä»¬åˆ©ç”¨äº†åˆ¤æ–­ isComponent æ¥å±•ç¤ºä¸åŒçš„ loading ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›é¡µé¢çº§çš„ loading æ˜¯â€œå…¨å±€â€çš„ï¼Œç»„ä»¶çº§æ˜¯åœ¨åŸæ¥çš„æ–‡æ¡£æµï¼Œè¿™é‡Œç”¨äº† `Teleport  :disabled="isComponent"` æ¥æ§åˆ¶æ˜¯å¦è·³å‡ºã€‚
4. ç»†å¿ƒçš„å°ä¼™ä¼´ä¼šå‘ç°è¿™é‡Œåšäº†ä¸€ä¸ªå»¶è¿Ÿæ˜¾ç¤º `delayShow`ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰è¿™ä¸ªå»¶è¿Ÿï¼Œåœ¨ç½‘ç»œç¯å¢ƒè‰¯å¥½çš„æƒ…å†µä¸‹ï¼Œloading æ¯æ¬¡éƒ½ä¼šä¸€é—ªè€Œè¿‡ï¼Œä¼šæœ‰ä¸€ç§â€œåä¼˜åŒ–â€çš„æ„Ÿè§‰ã€‚

è°ƒç”¨ HOCLazyï¼š
ä¸ºäº†æ›´å¥½çš„çœ‹å‡ºæ•ˆæœï¼Œæˆ‘ä»¬å°è£…äº† slow æ–¹æ³•æ¥å»¶è¿Ÿç»„ä»¶åŠ è½½ï¼š

utils/slow.ts

```JavaScript
const slow = (comp: any, delay: number = 1000): Promise<any> => {
  return new Promise(resolve => {
    setTimeout(() => resolve(comp), delay);
  });
};
export default slow;
```

è°ƒç”¨ï¼ˆç»„ä»¶çº§ï¼‰

```html
<template>
  <LazyComp1 str="hello~" />
</template>
const LazyComp1 = HOCLazy(
  () => slow(import('@/components/LazyComp1.vue'), 1000),
  true
);
// ...
components: {
  LazyComp1
},
// ...
```

çœ‹ä¸ªæ•ˆæœï¼š

![img](assets/db08aabf16354cb6a51c606d181a5d40tplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp)

> å…¶å®è¿™ä¸ React ä¸­çš„ `React.lazy + React.Suspense` çš„æ¦‚å¿µæ˜¯ä¸€è‡´çš„ï¼Œä¹‹å‰å†™è¿‡çš„ä¸€ç¯‡æ–‡ç«  [ã€ŠReactä¸¨ç”¨æˆ·ä½“éªŒä¸¨hookç‰ˆ lazy loadingã€‹](https://juejin.cn/post/6898569401176424456)ï¼Œå°ä¼™ä¼´å¯ä»¥çœ‹çœ‹åšä¸‹å¯¹æ¯”~

#### refï¼Œreactiveï¼ŒtoRefï¼ŒtoRefs çš„åŒºåˆ«ä½¿ç”¨

##### refï¼ˆreferenceï¼‰

ref å’Œ reactive çš„å­˜åœ¨éƒ½æ˜¯äº†è¿½è¸ªå€¼å˜åŒ–ï¼ˆå“åº”å¼ï¼‰ï¼Œref æœ‰ä¸ªã€ŒåŒ…è£…ã€çš„æ¦‚å¿µï¼Œå®ƒç”¨æ¥åŒ…è£…åŸå§‹å€¼ç±»å‹ï¼Œå¦‚ string å’Œ number ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ä¸æ˜¯å¼•ç”¨ç±»å‹æ˜¯æ— æ³•è¿½è¸ªåç»­çš„å˜åŒ–çš„ã€‚ref è¿”å›çš„æ˜¯ä¸€ä¸ªåŒ…å« `.value` å±æ€§çš„å¯¹è±¡ã€‚

```JavaScript
setup(props, context) {
  const count = ref<number>(1);
  // èµ‹å€¼
  count.value = 2;
  // è¯»å–
  console.log('count.value :>> ', count.value);
  return { count };
}
```

åœ¨ template ä¸­ ref åŒ…è£…å¯¹è±¡ä¼šè¢«è‡ªåŠ¨å±•å¼€ï¼ˆRef Unwrappingï¼‰ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨æ¨¡æ¿é‡Œä¸ç”¨å† `.value`

```html
<template>  
  {{count}}
</template>
```

##### reactive

ä¸ Vue2 ä¸­çš„ `Vue.observable()` æ˜¯ä¸€ä¸ªæ¦‚å¿µã€‚
ç”¨æ¥è¿”å›ä¸€ä¸ªå“åº”å¼å¯¹è±¡ï¼Œå¦‚:

```JavaScript
const obj = reactive({
  count: 0
})
// æ”¹å˜
obj.count++
```

**æ³¨æ„ï¼šå®ƒç”¨æ¥è¿”å›ä¸€ä¸ªå“åº”å¼å¯¹è±¡ï¼Œæœ¬èº«å°±æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥ä¸éœ€è¦åŒ…è£…ã€‚æˆ‘ä»¬ä½¿ç”¨å®ƒçš„å±æ€§ï¼Œä¸éœ€è¦åŠ  `.value` æ¥è·å–ã€‚**

##### toRefs

> å®˜ç½‘ï¼šå› ä¸º props æ˜¯å“åº”å¼çš„ï¼Œä½ ä¸èƒ½ä½¿ç”¨ ES6 è§£æ„ï¼Œå› ä¸ºå®ƒä¼šæ¶ˆé™¤ prop çš„å“åº”æ€§ã€‚

è®©æˆ‘ä»¬å…³æ³¨ `setup` æ–¹æ³•çš„ props çš„ç›¸å…³æ“ä½œï¼š

```html
htmlå¤åˆ¶ä»£ç <template>
  {{name}}
  <button @click="handleClick">ç‚¹æˆ‘</button>
</template>
// ...
props: {
  name: { type: String, default: ' ' }
},
setup(props) {
  const { name } = props;
  const handleClick = () => {
    console.log('name :>> ', name);
  };
  return { handleClick };
}
// ...
```

**æ³¨æ„ï¼šprops æ— éœ€é€šè¿‡ setup å‡½æ•° returnï¼Œä¹Ÿå¯ä»¥åœ¨ template è¿›è¡Œç»‘å®šå¯¹åº”çš„å€¼**

æˆ‘ä»¬éƒ½çŸ¥é“è§£æ„æ˜¯ es6 ä¸€ç§ä¾¿æ·çš„æ‰‹æ®µï¼Œç¼–è¯‘æˆ es5 ï¼Œå¦‚ï¼š

```JavaScript
JavaScriptå¤åˆ¶ä»£ç // es6 syntax
const { name } = props;
// to es5 syntax
var name = props.name;
```

å‡è®¾çˆ¶ç»„ä»¶æ›´æ”¹äº† props.name å€¼ï¼Œå½“æˆ‘ä»¬å†ç‚¹å‡»äº† button è¾“å‡ºçš„ name å°±è¿˜æ˜¯ä¹‹å‰çš„å€¼ï¼Œä¸ä¼šè·Ÿç€å˜åŒ–ï¼Œè¿™å…¶å®æ˜¯ä¸€ä¸ªåŸºç¡€çš„ js çš„çŸ¥è¯†ç‚¹ã€‚

ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬å¯¹å®ƒè¿›è¡ŒåŒ…è£…ï¼Œ`toRefs` å¯ä»¥ç†è§£æˆæ‰¹é‡åŒ…è£… props å¯¹è±¡ï¼Œå¦‚ï¼š

```javascript
javascriptå¤åˆ¶ä»£ç const { name } = toRefs(props);
const handleClick = () => {
  // å› ä¸ºæ˜¯åŒ…è£…å¯¹è±¡ï¼Œæ‰€ä»¥è¯»å–çš„æ—¶å€™è¦ç”¨.value
  console.log('name :>> ', name.value);
};
```

**å¯ä»¥ç†è§£è¿™ä¸€åˆ‡éƒ½æ˜¯å› ä¸ºæˆ‘ä»¬è¦ç”¨è§£æ„ï¼Œ`toRefs` æ‰€é‡‡å–çš„è§£å†³æ–¹æ¡ˆã€‚**

##### toRef

toRef çš„ç”¨æ³•ï¼Œå°±æ˜¯å¤šäº†ä¸€ä¸ªå‚æ•°ï¼Œå…è®¸æˆ‘ä»¬é’ˆå¯¹ä¸€ä¸ª key è¿›è¡ŒåŒ…è£…ï¼Œå¦‚ï¼š

```JavaScript
const name = toRef(props,'name');
console.log('name :>> ', name.value);
```

#### watchEffect vs watch

Vue3 çš„ watch æ–¹æ³•ä¸ Vue2 çš„æ¦‚å¿µç±»ä¼¼ï¼ŒwatchEffect ä¼šè®©æˆ‘ä»¬æœ‰äº›ç–‘æƒ‘ã€‚å…¶å® watchEffect ä¸ watch å¤§ä½“ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºï¼š

watch å¯ä»¥åšåˆ°çš„

- æ‡’æ‰§è¡Œå‰¯ä½œç”¨
- æ›´å…·ä½“åœ°è¯´æ˜ä»€ä¹ˆçŠ¶æ€åº”è¯¥è§¦å‘ä¾¦å¬å™¨é‡æ–°è¿è¡Œ
- è®¿é—®ä¾¦å¬çŠ¶æ€å˜åŒ–å‰åçš„å€¼

å¯¹äº Vue2 çš„ watch æ–¹æ³•ï¼ŒVue3 çš„ "watch" å¤šäº†ä¸€ä¸ªã€Œæ¸…é™¤å‰¯ä½œç”¨ã€ çš„æ¦‚å¿µï¼Œæˆ‘ä»¬ç€é‡å…³æ³¨è¿™ç‚¹ã€‚

è¿™é‡Œæ‹¿ `watchEffect` æ¥ä¸¾ä¾‹ï¼š

> watchEffectï¼šå®ƒç«‹å³æ‰§è¡Œä¼ å…¥çš„ä¸€ä¸ªå‡½æ•°ï¼ŒåŒæ—¶å“åº”å¼è¿½è¸ªå…¶ä¾èµ–ï¼Œå¹¶åœ¨å…¶ä¾èµ–å˜æ›´æ—¶é‡æ–°è¿è¡Œè¯¥å‡½æ•°ã€‚

watchEffect æ–¹æ³•ç®€å•ç»“æ„

```JavaScript
watchEffect(onInvalidate => {
  // æ‰§è¡Œå‰¯ä½œç”¨
  // do something...
  onInvalidate(() => {
    // æ‰§è¡Œ/æ¸…ç†å¤±æ•ˆå›è°ƒ
    // do something...
  })
})
```

æ‰§è¡Œå¤±æ•ˆå›è°ƒï¼Œæœ‰ä¸¤ä¸ªæ—¶æœº

- å‰¯ä½œç”¨å³å°†é‡æ–°æ‰§è¡Œæ—¶ï¼Œä¹Ÿå°±æ˜¯ç›‘å¬çš„æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶
- ç»„ä»¶å¸è½½æ—¶

ä¸€ä¸ªä¾‹å­ï¼šæˆ‘ä»¬è¦é€šè¿‡ id å‘èµ·è¯·æ±‚è·å–ã€Œæ°´æœã€çš„è¯¦æƒ…ï¼Œæˆ‘ä»¬ç›‘å¬ idï¼Œå½“ id åˆ‡æ¢è¿‡äºé¢‘ç¹ï¼ˆè¿˜æ²¡ç­‰ä¸Šä¸ªå¼‚æ­¥æ•°æ®è¿”å›æˆåŠŸï¼‰ã€‚å¯èƒ½ä¼šå¯¼è‡´æœ€å `id=1` çš„æ•°æ®è¦†ç›–äº†`id=2` çš„æ•°æ®ï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬å¸Œæœ›çš„ã€‚

æˆ‘ä»¬æ¥æ¨¡æ‹Ÿå¹¶è§£å†³è¿™ä¸ªåœºæ™¯ï¼š

æ¨¡æ‹Ÿæ¥å£ getFruitsById

```JavaScript
interface IFruit {
  id: number;
  name: string;
  imgs: string;
}
const list: { [key: number]: IFruit } = {
  1: { id: 1, name: 'è‹¹æœ', imgs: 'https://xxx.apple.jpg' },
  2: { id: 2, name: 'é¦™è•‰', imgs: 'https://xxx.banana.jpg' }
};
const getFruitsById = (
  id: number,
  delay: number = 3000
): [Promise<IFruit>, () => void] => {
  let _reject: (reason?: any) => void;
  const _promise: Promise<IFruit> = new Promise((resolve, reject) => {
    _reject = reject;
    setTimeout(() => {
      resolve(list[id]);
    }, delay);
  });
  return [
    _promise,
    () =>
      _reject({
        message: 'abort~'
      })
  ];
};
```

è¿™é‡Œå°è£…äº†â€œå–æ¶ˆè¯·æ±‚â€çš„æ–¹æ³•ï¼Œåˆ©ç”¨ reject æ¥å®Œæˆè¿™ä¸€åŠ¨ä½œã€‚

åœ¨ setup æ–¹æ³•

```JavaScript
setup() {
  const id = ref<number>(1);
  const detail = ref<IFruit | {}>({});

  watchEffect(async onInvalidate => {
    onInvalidate(() => {
      cancel && cancel();
    });
    // æ¨¡æ‹Ÿid=2çš„æ—¶å€™è¯·æ±‚æ—¶é—´ 1sï¼Œid=1çš„æ—¶å€™è¯·æ±‚æ—¶é—´ 2s
    const [p, cancel] = getFruitsById(id.value, id.value === 2 ? 1000 : 2000);
    const res = await p;
    detail.value = res;
  });
  // æ¨¡æ‹Ÿé¢‘ç¹åˆ‡æ¢idï¼Œè·å–é¦™è•‰çš„æ—¶å€™ï¼Œè·å–è‹¹æœçš„ç»“æœè¿˜æ²¡æœ‰å›æ¥ï¼Œå–æ¶ˆè‹¹æœçš„è¯·æ±‚ï¼Œä¿è¯æ•°æ®ä¸ä¼šè¢«è¦†ç›–
  id.value = 2;
  // æœ€å detail å€¼ä¸º { "id": 2, "name": "é¦™è•‰", "imgs": "https://xxx.banana.jpg" }
}
```

å¦‚æœæ²¡æœ‰æ‰§è¡Œ `cancel()` ï¼Œé‚£ä¹ˆ detail çš„æ•°æ®å°†ä¼šæ˜¯  `{ "id": 1, "name": "è‹¹æœ", "imgs": "https://xxx.apple.jpg" }`ï¼Œå› ä¸º id=1 æ•°æ®æ¯”è¾ƒâ€œæ™šæ¥æ”¶åˆ°â€ã€‚

è¿™å°±æ˜¯åœ¨å¼‚æ­¥åœºæ™¯ä¸‹å¸¸è§çš„ä¾‹å­ï¼Œæ¸…ç†å¤±æ•ˆçš„å›è°ƒï¼Œä¿è¯å½“å‰å‰¯ä½œç”¨æœ‰æ•ˆï¼Œä¸ä¼šè¢«è¦†ç›–ã€‚æ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥ç»§ç»­æ·±ç©¶ã€‚

#### fragmentï¼ˆç‰‡æ®µï¼‰

æˆ‘ä»¬éƒ½çŸ¥é“åœ¨å°è£…ç»„ä»¶çš„æ—¶å€™ï¼Œåªèƒ½æœ‰ä¸€ä¸ª root ã€‚åœ¨ Vue3 å…è®¸æˆ‘ä»¬æœ‰å¤šä¸ª root ï¼Œä¹Ÿå°±æ˜¯ç‰‡æ®µï¼Œä½†æ˜¯åœ¨ä¸€äº›æ“ä½œå€¼å¾—æˆ‘ä»¬æ³¨æ„ã€‚

å½“ `inheritAttrs=true[é»˜è®¤]` æ—¶ï¼Œç»„ä»¶ä¼šè‡ªåŠ¨åœ¨ root ç»§æ‰¿åˆå¹¶ class ï¼Œå¦‚ï¼š

å­ç»„ä»¶

```html
<template>
  <div class="fragment">
    <div>div1</div>
    <div>div2</div>
  </div>
</template>
```

çˆ¶ç»„ä»¶è°ƒç”¨ï¼Œæ–°å¢äº†ä¸€ä¸ª class

```html
<MyFragment class="extend-class" />
```

å­ç»„ä»¶ä¼šè¢«æ¸²æŸ“æˆ

```html
<div class="fragment extend-class">
  <div> div1 </div>
  <div> div2 </div>
</div>
```

å¦‚æœæˆ‘ä»¬ä½¿ç”¨äº† ç‰‡æ®µ ï¼Œå°±éœ€è¦æ˜¾å¼çš„å»æŒ‡å®šç»‘å®š attrs ï¼Œå¦‚å­ç»„ä»¶ï¼š

```html
<template>
  <div v-bind="$attrs">div1</div>
  <div>div2</div>
</template>
```

#### emits

åœ¨ Vue2 æˆ‘ä»¬ä¼šå¯¹ props é‡Œçš„æ•°æ®è¿›è¡Œè§„å®šç±»å‹ï¼Œé»˜è®¤å€¼ï¼Œéç©ºç­‰ä¸€äº›éªŒè¯ï¼Œå¯ä»¥ç†è§£ emits åšäº†ç±»ä¼¼çš„äº‹æƒ…ï¼ŒæŠŠ emit è§„èŒƒèµ·æ¥ï¼Œå¦‚ï¼š

```JavaScript
// ä¹Ÿå¯ä»¥ç›´æ¥ç”¨æ•°ç»„ï¼Œä¸åšéªŒè¯
// emits: ['on-update', 'on-other'],
emits: {
  // èµ‹å€¼ null ä¸éªŒè¯
  'on-other': null,
  // éªŒè¯
  'on-update'(val: number) {
    if (val === 1) {
      return true;
    }
    // è‡ªå®šä¹‰æŠ¥é”™
    console.error('val must be 1');
    return false;
  }
},
setup(props, ctx) {
  const handleEmitUpdate = () => {
    // éªŒè¯ val ä¸ä¸º 1ï¼Œæ§åˆ¶å°æŠ¥é”™
    ctx.emit('on-update', 2);
  };
  const handleEmitOther = () => {
    ctx.emit('on-other');
  };
  return { handleEmitUpdate, handleEmitOther };
}
```

åœ¨ setup ä¸­ï¼Œemit å·²ç»ä¸å†ç”¨ `this.$emit` äº†ï¼Œè€Œæ˜¯ setup çš„ç¬¬äºŒä¸ªå‚æ•° `context` ä¸Šä¸‹æ–‡æ¥è·å– emit ã€‚

#### v-model

ä¸ªäººè¿˜æ˜¯æŒºå–œæ¬¢ v-model çš„æ›´æ–°çš„ï¼Œå¯ä»¥æå‡å°è£…ç»„ä»¶çš„ä½“éªŒæ„Ÿ~

> åœ¨Vue2ï¼Œå‡è®¾æˆ‘éœ€è¦å°è£…ä¸€ä¸ªå¼¹æ¡†ç»„ä»¶ Modalï¼Œç”¨ `show` å˜é‡æ¥æ§åˆ¶å¼¹æ¡†çš„æ˜¾ç¤ºéšè—ï¼Œè¿™è‚¯å®šæ˜¯ä¸€ä¸ªçˆ¶å­ç»„ä»¶éƒ½è¦ç»´æŠ¤çš„å€¼ã€‚å› ä¸ºå•å‘æ•°æ®æµï¼Œæ‰€ä»¥éœ€è¦åœ¨ Modal ç»„ä»¶ emit ä¸€ä¸ªäº‹ä»¶ï¼Œçˆ¶ç»„ä»¶ç›‘å¬äº‹ä»¶æ¥æ”¶å¹¶ä¿®æ”¹è¿™ä¸ª `show` å€¼ã€‚
> ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬ä¼šæœ‰ä¸€äº›è¯­æ³•ç³–ï¼Œå¦‚ v-modelï¼Œä½†æ˜¯åœ¨ Vue2 ä¸€ä¸ªç»„ä»¶ä¸Šåªèƒ½æœ‰ä¸€ä¸ª v-model ï¼Œå› ä¸ºè¯­æ³•ç³–çš„èƒŒåæ˜¯ `value` å’Œ `@input` çš„ç»„æˆï¼Œ å¦‚æœè¿˜æœ‰å¤šä¸ªç±»ä¼¼è¿™æ ·çš„ â€œåŒå‘ä¿®æ”¹æ•°æ®â€ï¼Œæˆ‘ä»¬å°±éœ€è¦ç”¨è¯­æ³•ç³– `.sync` åŒæ­¥ä¿®é¥°ç¬¦ã€‚

Vue3 æŠŠè¿™ä¸¤ä¸ªè¯­æ³•ç³–ç»Ÿä¸€äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨å¯ä»¥åœ¨ä¸€ä¸ªç»„ä»¶ä¸Šä½¿ç”¨ å¤šä¸ª v-model è¯­æ³•ç³–ï¼Œä¸¾ä¸ªä¾‹å­ï¼š

å…ˆä»çˆ¶ç»„ä»¶çœ‹

```html
<VModel v-model="show"
        v-model:model1="check"
        v-model:model2.hello="textVal" />
```

**helloä¸ºè‡ªå®šä¹‰ä¿®é¥°ç¬¦**

æˆ‘ä»¬åœ¨ä¸€ä¸ªç»„ä»¶ä¸Šç”¨äº† 3 ä¸ª v-model è¯­æ³•ç³–ï¼Œåˆ†åˆ«æ˜¯

| v-model è¯­æ³•ç³–     | å¯¹åº”çš„ prop | å¯¹åº”çš„ event      | è‡ªå®šä¹‰ä¿®é¥°ç¬¦å¯¹åº”çš„ prop |
| ------------------ | ----------- | ----------------- | ----------------------- |
| v-modelï¼ˆdefaultï¼‰ | modelValue  | update:modelValue | æ—                       |
| v-model:model1     | model1      | update:model1     | æ—                       |
| v-model:model2     | model2      | update:model2     | model2Modifiers         |

è¿™æ ·å­æˆ‘ä»¬å°±æ›´æ¸…æ™°çš„åœ¨å­ç»„ä»¶æˆ‘ä»¬è¦è¿›è¡Œä¸€äº›ä»€ä¹ˆå°è£…äº†ï¼Œå¦‚ï¼š

VModel.vue

```JavaScript
// ...
props: {
  modelValue: { type: Boolean, default: false },
  model1: { type: Boolean, default: false },
  model2: { type: String, default: '' },
  model2Modifiers: {
    type: Object,
    default: () => ({})
  }
},
emits: ['update:modelValue', 'update:model1', 'update:model2'],
// ...
```

#### key attribute

```html
<template>
  <input type="text"
         placeholder="è¯·è¾“å…¥è´¦å·"
         v-if="show" />
  <input type="text"
         placeholder="è¯·è¾“å…¥é‚®ç®±"
         v-else />
  <button @click="show=!show">Toggle</button>
</template>
```

ç±»ä¼¼è¿™æ ·çš„ v-if/v-elseï¼Œåœ¨ Vue2 ä¸­ï¼Œä¼šå°½å¯èƒ½é«˜æ•ˆåœ°æ¸²æŸ“å…ƒç´ ï¼Œé€šå¸¸ä¼šå¤ç”¨å·²æœ‰å…ƒç´ è€Œä¸æ˜¯ä»å¤´å¼€å§‹æ¸²æŸ“ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ª input ä¸­è¾“å…¥ï¼Œç„¶ååˆ‡æ¢ç¬¬äºŒä¸ª input ã€‚ç¬¬ä¸€ä¸ª input çš„å€¼å°†ä¼šè¢«ä¿ç•™å¤ç”¨ã€‚

æœ‰äº›åœºæ™¯ä¸‹æˆ‘ä»¬ä¸è¦å¤ç”¨å®ƒä»¬ï¼Œéœ€è¦æ·»åŠ ä¸€ä¸ªå”¯ä¸€çš„ key ï¼Œå¦‚ï¼š

```html
<template>
  <input type="text"
         placeholder="è¯·è¾“å…¥è´¦å·"
         v-if="show"
         key="account" />
  <input type="text"
         placeholder="è¯·è¾“å…¥é‚®ç®±"
         v-else
         key="email" />
  <button @click="show=!show">Toggle</button>
</template>
```

**ä½†æ˜¯åœ¨ Vue3 æˆ‘ä»¬ä¸ç”¨æ˜¾å¼çš„å»æ·»åŠ  key ï¼Œè¿™ä¸¤ä¸ª input å…ƒç´ ä¹Ÿæ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼Œå› ä¸º Vue3 ä¼šå¯¹ v-if/v-else è‡ªåŠ¨ç”Ÿæˆå”¯ä¸€çš„ keyã€‚**

#### å…¨å±€ API

åœ¨ Vue2 æˆ‘ä»¬å¯¹äºä¸€äº›å…¨å±€çš„é…ç½®å¯èƒ½æ˜¯è¿™æ ·å­çš„ï¼Œä¾‹å¦‚æˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªæ’ä»¶

```JavaScript
Vue.use({
  /* ... */
});
const app1 = new Vue({ el: '#app-1' });
const app2 = new Vue({ el: '#app-2' });
```

ä½†æ˜¯è¿™æ ·å­è¿™ä¼šå½±å“ä¸¤ä¸ªæ ¹å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¼šå˜å¾—ä¸å¯æ§ã€‚

åœ¨ Vue3 å¼•å…¥ä¸€ä¸ªæ–°çš„ API `createApp` æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªå®ä¾‹ï¼š

```JavaScript
import { createApp } from 'vue';
const app = createApp({ /* ... */ });
```

ç„¶åæˆ‘ä»¬å°±å¯ä»¥åœ¨è¿™ä¸ªå®ä¾‹ä¸ŠæŒ‚è½½å…¨å±€ç›¸å…³æ–¹æ³•ï¼Œå¹¶åªå¯¹å½“å‰å®ä¾‹ç”Ÿæ•ˆï¼Œå¦‚ï¼š

```JavaScript
app
  .component(/* ... */)
  .directive(/* ... */ )
  .mixin(/* ... */ )
  .use(/* ... */ )
  .mount('#app');
```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ Vue2 æˆ‘ä»¬ç”¨äº† `Vue.prototype.$http=()=>{}` è¿™æ ·çš„å†™æ³•ï¼Œæ¥å¯¹ â€œæ ¹Vueâ€ çš„ prototype è¿›è¡ŒæŒ‚è½½æ–¹æ³•ï¼Œä½¿å¾—æˆ‘ä»¬åœ¨å­ç»„ä»¶ï¼Œå¯ä»¥é€šè¿‡åŸå‹é“¾çš„æ–¹å¼æ‰¾åˆ° `$http` æ–¹æ³•ï¼Œå³ `this.$http`ã€‚

è€Œåœ¨ Vue3 æˆ‘ä»¬ç±»ä¼¼è¿™æ ·çš„æŒ‚è½½éœ€è¦ç”¨ä¸€ä¸ªæ–°çš„å±æ€§ `globalProperties` ï¼š

```JavaScript
app.config.globalProperties.$http = () => {}
```

åœ¨ setup å†…éƒ¨ä½¿ç”¨ `$http` ï¼š

```JavaScript
setup() {
  const {
    appContext: {
      config: {
        globalProperties: { $http }
      }
    }
  } = getCurrentInstance()
}
```

### 2. åº•å±‚ä¼˜åŒ–

#### Proxy ä»£ç†

Vue2 å“åº”å¼çš„åŸºæœ¬åŸç†ï¼Œå°±æ˜¯é€šè¿‡ `Object.defineProperty`ï¼Œä½†è¿™ä¸ªæ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚ä½¿å¾— Vue ä¸å¾—ä¸é€šè¿‡ä¸€äº›æ‰‹æ®µæ¥ hackï¼Œå¦‚ï¼š

- Vue.$set() åŠ¨æ€æ·»åŠ æ–°çš„å“åº”å¼å±æ€§
- æ— æ³•ç›‘å¬æ•°ç»„å˜åŒ–ï¼ŒVue åº•å±‚éœ€è¦å¯¹æ•°ç»„çš„ä¸€äº›æ“ä½œæ–¹æ³•ï¼Œè¿›è¡Œå†å°è£…ã€‚å¦‚ `push`ï¼Œ`pop ` ç­‰æ–¹æ³•ã€‚

è€Œåœ¨ Vue3 ä¸­ä¼˜å…ˆä½¿ç”¨äº† Proxy æ¥å¤„ç†ï¼Œå®ƒä»£ç†çš„æ˜¯æ•´ä¸ªå¯¹è±¡è€Œä¸æ˜¯å¯¹è±¡çš„å±æ€§ï¼Œå¯å¯¹äºæ•´ä¸ªå¯¹è±¡è¿›è¡Œæ“ä½œã€‚ä¸ä»…æå‡äº†æ€§èƒ½ï¼Œä¹Ÿæ²¡æœ‰ä¸Šé¢æ‰€è¯´çš„ç¼ºé™·ã€‚

ç®€å•ä¸¾ä¸¤ä¸ªä¾‹å­ï¼š

1. åŠ¨æ€æ·»åŠ å“åº”å¼å±æ€§

```JavaScript
const targetObj = { id: '1', name: 'zhagnsan' };
const proxyObj = new Proxy(targetObj, {
  get: function (target, propKey, receiver) {
    console.log(`getting keyï¼š${propKey}`);
    return Reflect.get(...arguments);
  },
  set: function (target, propKey, value, receiver) {
    console.log(`setting keyï¼š${propKey}ï¼Œvalueï¼š${value}`);
    return Reflect.set(...arguments);
  }
});
proxyObj.age = 18;
// setting keyï¼šageï¼Œvalueï¼š18
```

å¦‚ä¸Šï¼Œç”¨ `Proxy` æˆ‘ä»¬å¯¹ `proxyObj` å¯¹è±¡åŠ¨æ€æ·»åŠ çš„å±æ€§ä¹Ÿä¼šè¢«æ‹¦æˆªåˆ°ã€‚

`Reflect` å¯¹è±¡æ˜¯ES6 ä¸ºäº†æ“ä½œå¯¹è±¡è€Œæä¾›çš„æ–° APIã€‚å®ƒæœ‰å‡ ä¸ªå†…ç½®çš„æ–¹æ³•ï¼Œå°±å¦‚ä¸Šé¢çš„ `get` / `set`ï¼Œè¿™é‡Œå¯ä»¥ç†è§£æˆæˆ‘ä»¬ç”¨ `Reflect` æ›´åŠ æ–¹ä¾¿ï¼Œå¦åˆ™æˆ‘ä»¬éœ€è¦å¦‚ï¼š

```JavaScript
get: function (target, propKey, receiver) {
  console.log(`getting ${propKey}!`);
  return target[propKey];
},
```

1. å¯¹æ•°ç»„çš„æ“ä½œè¿›è¡Œæ‹¦æˆª

```JavaScript
const targetArr = [1, 2];
const proxyArr = new Proxy(targetArr, {
  set: function (target, propKey, value, receiver) {
    console.log(`setting keyï¼š${propKey}ï¼Œvalueï¼š${value}`);
    return Reflect.set(...arguments);
  }
});
proxyArr.push('3');
// setting keyï¼š2ï¼Œvalueï¼š3
// setting keyï¼šlengthï¼Œvalueï¼š3
```

#### é™æ€æå‡ï¼ˆhoistStaticï¼‰ vdom

æˆ‘ä»¬éƒ½çŸ¥é“ Vue æœ‰è™šæ‹Ÿdomçš„æ¦‚å¿µï¼Œå®ƒèƒ½ä¸ºæˆ‘ä»¬åœ¨æ•°æ®æ”¹å˜æ—¶é«˜æ•ˆçš„æ¸²æŸ“é¡µé¢ã€‚

Vue3 ä¼˜åŒ–äº† vdom çš„æ›´æ–°æ€§èƒ½ï¼Œç®€å•ä¸¾ä¸ªä¾‹å­

Template

```html
<div class="div">
  <div>content</div>
  <div>{{message}}</div>
</div>
```

Compiler åï¼Œæ²¡æœ‰é™æ€æå‡

```JavaScript
function render(_ctx, _cache, $props, $setup, $data, $options) {
  return (_openBlock(), _createBlock("div", { class: "div" }, [
    _createVNode("div", null, "content"),
    _createVNode("div", null, _toDisplayString(_ctx.message), 1 /* TEXT */)
  ]))
}
```

Compiler åï¼Œæœ‰é™æ€æå‡

```JavaScript
const _hoisted_1 = { class: "div" }
const _hoisted_2 = /*#__PURE__*/_createVNode("div", null, "content", -1 /* HOISTED */)

function render(_ctx, _cache, $props, $setup, $data, $options) {
  return (_openBlock(), _createBlock("div", _hoisted_1, [
    _hoisted_2,
    _createVNode("div", null, _toDisplayString(_ctx.message), 1 /* TEXT */)
  ]))
}
```

é™æ€æå‡åŒ…å«ã€Œé™æ€èŠ‚ç‚¹ã€å’Œã€Œé™æ€å±æ€§ã€çš„æå‡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æŠŠä¸€äº›é™æ€çš„ä¸ä¼šå˜çš„èŠ‚ç‚¹ç”¨å˜é‡ç¼“å­˜èµ·æ¥ï¼Œæä¾›ä¸‹æ¬¡ re-render ç›´æ¥è°ƒç”¨ã€‚
å¦‚æœæ²¡æœ‰åšè¿™ä¸ªåŠ¨ä½œï¼Œå½“ `render` é‡æ–°æ‰§è¡Œæ—¶ï¼Œå³ä½¿æ ‡ç­¾æ˜¯é™æ€çš„ï¼Œä¹Ÿä¼šè¢«é‡æ–°åˆ›å»ºï¼Œè¿™å°±ä¼šäº§ç”Ÿæ€§èƒ½æ¶ˆè€—ã€‚

### 3. ä¸ TS

> 3.0 çš„ä¸€ä¸ªä¸»è¦è®¾è®¡ç›®æ ‡æ˜¯å¢å¼ºå¯¹ TypeScript çš„æ”¯æŒã€‚åŸæœ¬æˆ‘ä»¬æœŸæœ›é€šè¿‡ Class API æ¥è¾¾æˆè¿™ä¸ªç›®æ ‡ï¼Œä½†æ˜¯ç»è¿‡è®¨è®ºå’ŒåŸå‹å¼€å‘ï¼Œæˆ‘ä»¬è®¤ä¸º Class å¹¶ä¸æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„æ­£ç¡®è·¯çº¿ï¼ŒåŸºäº Class çš„ API ä¾ç„¶å­˜åœ¨ç±»å‹é—®é¢˜ã€‚â€”â€”å°¤é›¨æºª

> åŸºäºå‡½æ•°çš„ API å¤©ç„¶ ä¸ TS å®Œç¾ç»“åˆã€‚

#### defineComponent

åœ¨ TS ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ Vue æš´éœ²çš„æ–¹æ³• defineComponentï¼Œå®ƒå•çº¯ä¸ºäº†ç±»å‹æ¨å¯¼è€Œå­˜åœ¨çš„ã€‚

#### props æ¨å¯¼

```Typescript
import { defineComponent } from 'vue';
export default defineComponent({
  props: {
    val1: String,
    val2: { type: String, default: '' },
  },
  setup(props, context) {
    props.val1;
  }
})
```

å½“æˆ‘ä»¬åœ¨ setup æ–¹æ³•è®¿é—® props æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¢«æ¨å¯¼åçš„ç±»å‹ï¼Œ

- val1 æˆ‘ä»¬æ²¡æœ‰è®¾ç½®é»˜è®¤å€¼ï¼Œæ‰€ä»¥å®ƒä¸º `string | undefined`
- è€Œ val2 çš„å€¼æœ‰å€¼ï¼Œæ‰€ä»¥æ˜¯ `string`ï¼Œå¦‚å›¾ï¼š

#### PropType

æˆ‘ä»¬å…³æ³¨ä¸€ä¸‹ props å®šä¹‰çš„ç±»å‹ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªå¤æ‚å¯¹è±¡ï¼Œæˆ‘ä»¬å°±è¦ç”¨ PropType æ¥è¿›è¡Œå¼ºè½¬å£°æ˜ï¼Œå¦‚ï¼š

```JavaScript
interface IObj {
  id: number;
  name: string;
}

obj: {
  type: Object as PropType<IObj>,
  default: (): IObj => ({ id: 1, name: 'å¼ ä¸‰' })
},
```

æˆ– è”åˆç±»å‹

```JavaScript
type: {
  type: String as PropType<'success' | 'error' | 'warning'>,
  default: 'warning'
},
```

### 4. buildä¸¨æ›´å¥½çš„ tree-sharkingï¼ˆæ‘‡æ ‘ä¼˜åŒ–ï¼‰

> tree-sharking å³åœ¨æ„å»ºå·¥å…·æ„å»ºåæ¶ˆé™¤ç¨‹åºä¸­æ— ç”¨çš„ä»£ç ï¼Œæ¥å‡å°‘åŒ…çš„ä½“ç§¯ã€‚

åŸºäºå‡½æ•°çš„ API æ¯ä¸€ä¸ªå‡½æ•°éƒ½å¯ä»¥ç”¨ `import { method1ï¼Œmethod2 } from "xxx";`ï¼Œè¿™å°±å¯¹ tree-sharking éå¸¸å‹å¥½ï¼Œè€Œä¸”å‡½æ•°ååŒå˜é‡åéƒ½å¯ä»¥è¢«å‹ç¼©ï¼Œå¯¹è±¡å»ä¸å¯ä»¥ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å°è£…äº†ä¸€ä¸ªå·¥å…·ï¼Œå·¥å…·æä¾›äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œç”¨ `method1`ï¼Œ`method2` æ¥ä»£æ›¿ã€‚

æˆ‘ä»¬æŠŠå®ƒä»¬å°è£…æˆä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”æš´éœ²å‡ºå»ï¼Œå¦‚ï¼š

```JavaScript
// utils
const obj = {
  method1() {},
  method2() {}
};
export default obj;
JavaScriptå¤åˆ¶ä»£ç // è°ƒç”¨
import util from '@/utils';
util.method1();
```

ç»è¿‡webpackæ‰“åŒ…å‹ç¼©ä¹‹åä¸ºï¼š

```JavaScript
a={method1:function(){},method2:function(){}};a.method1();
```

æˆ‘ä»¬ä¸ç”¨å¯¹è±¡çš„å½¢å¼ï¼Œè€Œç”¨å‡½æ•°çš„å½¢å¼æ¥çœ‹çœ‹ï¼š

```JavaScript
// utils
export function method1() {}
export function method2() {}
JavaScriptå¤åˆ¶ä»£ç // è°ƒç”¨
import { method1 } from '@/utils';
method1();
```

ç»è¿‡webpackæ‰“åŒ…å‹ç¼©ä¹‹åä¸ºï¼š

```JavaScript
function a(){}a();
```

ç”¨è¿™ä¸ªä¾‹å­æˆ‘ä»¬å°±å¯ä»¥äº†è§£ Vue3 ä¸ºä»€ä¹ˆèƒ½æ›´å¥½çš„ tree-sharking ï¼Œå› ä¸ºå®ƒç”¨çš„æ˜¯åŸºäºå‡½æ•°å½¢å¼çš„APIï¼Œå¦‚ï¼š

```JavaScript
import {
  defineComponent,
  reactive,
  ref,
  watchEffect,
  watch,
  onMounted,
  toRefs,
  toRef
} from 'vue';
```

### 5. options api ä¸ composition api å–èˆ

æˆ‘ä»¬ä¸Šé¢çš„ä»£ç éƒ½æ˜¯åœ¨ setup å†…éƒ¨å®ç°ï¼Œä½†æ˜¯ç›®å‰ Vue3 è¿˜ä¿ç•™äº† Vue2 çš„ options api å†™æ³•ï¼Œå°±æ˜¯å¯ä»¥â€œå¹¶å­˜â€ï¼Œå¦‚ï¼š

```JavaScript
// ...
setup() {
  const val = ref<string>('');
  const fn = () => {};
  return {
    val,
    fn
  };
},
mounted() {
  // åœ¨ mounted ç”Ÿå‘½å‘¨æœŸå¯ä»¥è®¿é—®åˆ° setup return å‡ºæ¥çš„å¯¹è±¡
  console.log(this.val);
  this.fn();
},
// ...
```

ç»“åˆ react ï¼Œæˆ‘ä»¬çŸ¥é“ â€œå‡½æ•°å¼â€ï¼Œhook æ˜¯æœªæ¥çš„ä¸€ä¸ªè¶‹åŠ¿ã€‚

æ‰€ä»¥ä¸ªäººå»ºè®®è¿˜æ˜¯é‡‡ç”¨éƒ½åœ¨ `setup` å†…éƒ¨å†™é€»è¾‘çš„æ–¹å¼ï¼Œå› ä¸º Vue3 å¯ä»¥å®Œå…¨æä¾› Vue2 çš„å…¨éƒ¨èƒ½åŠ›ã€‚

## äºŒåäº”ã€vue3çš„slotç”¨æ³•æ±‡æ€»

![Vue3ä¸­æ’æ§½(slot)ç”¨æ³•æ±‡æ€»](assets/8386549cd93d4f08ae29c3f5c51671d8tplv-k3u1fbpfcp-zoom-crop-mark151215121512851.webp)

[Vueæºç ï¼ˆåï¼‰æ’æ§½åŸç†](https://juejin.cn/post/6997966632022704135)

### ä»€ä¹ˆæ˜¯æ’æ§½

ç®€å•æ¥è¯´å°±æ˜¯å­ç»„ä»¶ä¸­çš„æä¾›ç»™çˆ¶ç»„ä»¶ä½¿ç”¨çš„ä¸€ä¸ª`å‘ä½`ï¼Œç”¨`<slot></slot>` è¡¨ç¤ºï¼Œçˆ¶ç»„ä»¶å¯ä»¥åœ¨è¿™ä¸ªå‘ä½ä¸­å¡«å……ä»»ä½•æ¨¡æ¿ä»£ç ç„¶åå­ç»„ä»¶ä¸­`<slot></slot>`å°±ä¼šè¢«æ›¿æ¢æˆè¿™äº›å†…å®¹ã€‚æ¯”å¦‚ä¸€ä¸ªæœ€ç®€å•æ’æ§½ä¾‹å­

```javascript
//çˆ¶ç»„ä»¶
<template>
  <div>
    <Child>Hello Juejin</Child>
  </div>
</template>
<script setup lang="ts">
import Child from './Child.vue'
</script>

//å­ç»„ä»¶Child
<template>
    <div>
        <p>1</p>
        <slot />
        <p>2</p>
    </div>
</template>
```

å­ç»„ä»¶ä¸­çš„`<slot />` ä¾¿æ˜¯çˆ¶ç»„ä»¶æ”¾åœ¨å­ç»„ä»¶æ ‡ç­¾`<Child>`ä¹‹é—´çš„å†…å®¹ã€‚å½“ç„¶è¿™ä¹‹é—´ä½ å¯ä»¥ä¼ å…¥ä»»ä½•ä»£ç ç‰‡æ®µï¼Œéƒ½ä¼šè¢«æ”¾åˆ°`<slot />`è¿™ä¸ªä½ç½®ã€‚

åŒæ ·çš„ä½ ä¹Ÿå¯ä»¥åœ¨æ ‡ç­¾`<Child>`ä¹‹é—´æ”¾å…¥å˜é‡ï¼Œæ¯”å¦‚

```xml
//çˆ¶ç»„ä»¶
<template>
  <div>
    <Child>{{ msg }}</Child>
  </div>
</template>
<script setup lang="ts">
import { ref } from 'vue'
import Child from './Child.vue'
const msg = ref('Hello Juejin')
</script>
```

å…ˆè§£é‡Šä¸€ä¸‹åé¢é¢‘ç¹å‡ºç°çš„ä¸¤ä¸ªè¯ `æ’æ§½`å’Œ`æ’æ§½å†…å®¹`ï¼Œé˜²æ­¢åé¢é˜…è¯»ææ··äº†ï¼š

åŒæ ·çš„ `æ’æ§½`è¡¨ç¤ºçš„å°±æ˜¯è¿™ä¸ª`msg`å˜é‡ã€‚æ‰€ä»¥å­ç»„ä»¶ `æ’æ§½`æ˜¯å¯ä»¥è®¿é—®åˆ°çˆ¶ç»„ä»¶çš„æ•°æ®ä½œç”¨åŸŸï¼Œè€Œ`æ’æ§½å†…å®¹`æ˜¯æ— æ³•è®¿é—®å­ç»„ä»¶çš„æ•°æ®ï¼ˆå³çˆ¶ç»„ä»¶ä¸­ä¸¤ä¸ª`<Child>`ä¹‹é—´æ˜¯ä¸èƒ½ä½¿ç”¨å­ç»„ä»¶ä¸­çš„æ•°æ®çš„ï¼‰ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„æ¸²æŸ“ä½œç”¨åŸŸã€‚åé¢ä¼šä»‹ç»`æ’æ§½`å‘`æ’æ§½å†…å®¹`ä¼ å‚çš„æ–¹å¼

### é»˜è®¤å†…å®¹

åœ¨çˆ¶ç»„ä»¶æ²¡æœ‰æä¾›ä»»ä½•`æ’æ§½å†…å®¹`çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯å¯ä»¥ä¸ºå­ç»„ä»¶çš„`æ’æ§½`æŒ‡å®šé»˜è®¤å†…å®¹çš„ï¼Œæ¯”å¦‚

```javascript
//å­ç»„ä»¶
<template>
    <div>
        <slot>æˆ‘æ˜¯é»˜è®¤å†…å®¹</slot>
    </div>
</template>

//çˆ¶ç»„ä»¶1
<template>
  <div>
    <Child></Child>
  </div>
</template>
<script setup>
import Child from './Child.vue'
</script>

//çˆ¶ç»„ä»¶2
<template>
  <div>
    <Child>Hello Juejin</Child>
  </div>
</template>
<script setup>
import Child from './Child.vue'
</script>
```

### å…·åæ’æ§½

å¾ˆå¤šæ—¶å€™ä¸€ä¸ª `æ’æ§½`æ»¡è¶³ä¸äº†æˆ‘ä»¬çš„éœ€æ±‚ï¼Œæˆ‘ä»¬éœ€è¦å¤šä¸ª `æ’æ§½`ã€‚äºæ˜¯å°±æœ‰äº†`å…·åæ’æ§½`ï¼Œå°±æ˜¯å…·æœ‰åå­—çš„ `æ’æ§½`ã€‚ç®€å•æ¥è¯´è¿™ä¸ª`å…·åæ’æ§½`çš„ç›®çš„å°±æ˜¯è®©ä¸€ä¸ªèåœä¸€ä¸ªå‘ï¼Œè®©å®ƒä»¬å‘†åœ¨è¯¥å‘†çš„ä½ç½®å»ã€‚æ¯”å¦‚å¸¦ `name` çš„æ’æ§½` <slot name="xx">`è¢«ç§°ä¸ºå…·åæ’æ§½ã€‚æ²¡æœ‰æä¾› `name` çš„ `<slot>` ä¼šéšå¼åœ°å‘½åä¸ºâ€œdefaultâ€ã€‚åœ¨çˆ¶ç»„ä»¶ä¸­å¯ä»¥ä½¿ç”¨`v-slot:xxx`ï¼ˆå¯ç®€å†™ä¸º`#xxx`ï¼‰ æŒ‡ä»¤çš„ `<template>` å…ƒç´ å°†ç›®æ ‡æ’æ§½çš„åå­—ä¼ ä¸‹å»åŒ¹é…å¯¹åº” `æ’æ§½`ã€‚æ¯”å¦‚

```javascript
//å­ç»„ä»¶

<template>
    <div>
        <!-- å¤§èåœ -->
        <div>
            <slot name="bigTurnip"></slot>
        </div>
        <!-- å°èåœ -->
        <div>
            <slot name="smallTurnip"></slot>
        </div>
        <!-- ä¸­èåœ -->
        <div>
            <slot name="midTurnip"></slot>
        </div>
    </div>
</template>

//çˆ¶ç»„ä»¶

<template>
  <div>
    <Child>
      <!-- #smallTurnip ä¸ºv-slot:smallTurnipç¼©å†™ -->
      <template #smallTurnip>
        å°èåœ
      </template>
      <template #midTurnip>
        ä¸­èåœ
      </template>
      <template #bigTurnip>
        å¤§èåœ
      </template>
    </Child>
  </div>
</template>
<script setup>
import Child from './Child.vue'
</script>
```

æ‰€ä»¥çˆ¶ç»„ä»¶ä¸­æ— éœ€åœ¨æ„é¡ºåºï¼Œåªéœ€è¦å†™å¥½æ¨¡æ¿å‘½å¥½åï¼Œå®ƒå°±ä¼šè‡ªåŠ¨å»åˆ°å®ƒæ‰€å¯¹åº”çš„ä½ç½®ã€‚

### åŠ¨æ€æ’æ§½å

åŠ¨æ€æ’æ§½åå°±æ˜¯æ’æ§½åå˜æˆäº†å˜é‡çš„å½¢å¼ï¼Œæˆ‘ä»¬å¯ä»¥éšæ—¶ä¿®æ”¹è¿™ä¸ªå˜é‡ä»è€Œå±•ç¤ºä¸åŒçš„æ•ˆæœã€‚å®ƒçš„å†™æ³•æ˜¯`v-slot:[å˜é‡å]`æˆ–è€…ç¼©å†™ä¸º`#[å˜é‡å]`ã€‚

```xml
//çˆ¶ç»„ä»¶
<template>
  <div>
    <Child>
      <!-- ç­‰åŒäº#smallTurnip -->
      <template #[slotName]>
        å°èåœ
      </template>
      <template #midTurnip>
        ä¸­èåœ
      </template>
      <template #bigTurnip>
        å¤§èåœ
      </template>
    </Child>
  </div>
</template>
<script setup>
import { ref } from 'vue'
import Child from './Child.vue'
const slotName = ref('smallTurnip')
</script>
```

### ä½œç”¨åŸŸæ’æ§½

#### ä½œç”¨åŸŸæ’æ§½

ä¸Šé¢è¯´è¿‡`æ’æ§½å†…å®¹`æ˜¯æ— æ³•è®¿é—®å­ç»„ä»¶çš„æ•°æ®çš„ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³åœ¨`æ’æ§½å†…å®¹`è®¿é—®å­ç»„ä»¶çš„çŠ¶æ€è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ

å…¶å®`æ’æ§½`å¯ä»¥åƒå¯¹ç»„ä»¶ä¼ é€’ props é‚£æ ·ï¼Œåœ¨`slot`æ ‡ç­¾ç»‘å®šå±æ€§ä»è€Œä¼ é€’ç»™çˆ¶ç»„ä»¶ä¸­çš„`æ’æ§½å†…å®¹`ã€‚é¦–å…ˆæ¥çœ‹ä¸‹é»˜è®¤æ’æ§½çš„ä¼ å€¼æ–¹å¼

```javascript
//å­ç»„ä»¶
<template>
    <div>
        <slot personName="xiaoyue" age="18"></slot>
    </div>
</template>

//çˆ¶ç»„ä»¶

<template>
  <div>
    <Child v-slot="slotProps">
      My name is {{ slotProps.personName }} and I am {{ slotProps.age }} years old this year
    </Child>
  </div>
</template>
<script setup>
import Child from './Child.vue'
</script>
```

ä½ è¿˜å¯ä»¥ä»¥ç»“æ„çš„å½¢å¼è·å–`slot`æä¾›çš„æ•°æ®

```xml
<template>
  <div>
    <Child v-slot="{ personName, age }">
      My name is {{ personName }} and I am {{ age }} years old this year
    </Child>
  </div>
</template>
```

æ³¨æ„ä¸èƒ½ç»‘å®š`name`å±æ€§ï¼Œå› ä¸ºä½ ç»‘å®šäº†`name`å®ƒå°±æˆäº†å…·åæ’æ§½äº†ã€‚åŒæ ·å…·åæ’æ§½ä¸­çš„`name`å±æ€§ä¹Ÿä¸ä¼šä¼ é€’ç»™`æ’æ§½å†…å®¹`ã€‚è¿™ç§åœ¨çˆ¶ç»„ä»¶ä½œç”¨åŸŸä¸­è·å–åˆ°äº†å­ç»„ä»¶ä½œç”¨åŸŸä¸­çš„å˜é‡ï¼Œå¯ä»¥è®¤ä¸ºä½œç”¨åŸŸæ’æ§½å»¶ä¼¸äº†å­ç»„ä»¶æ•°æ®çš„ä½œç”¨èŒƒå›´ï¼Œæ‰€ä»¥è¿™ç±»èƒ½å¤Ÿæ¥å—å‚æ•°çš„æ’æ§½å°±è¢«ç§°ä¸ºäº†`ä½œç”¨åŸŸæ’æ§½`ã€‚

#### å…·åä½œç”¨åŸŸæ’æ§½

ä¸‹é¢å†çœ‹ä¸‹`å…·åä½œç”¨åŸŸæ’æ§½`å®ƒçš„ä¼ å‚æ–¹å¼ã€‚å®ƒæ¥æ”¶å‚æ•°çš„æ–¹å¼æ˜¯é€šè¿‡`template`æ ‡ç­¾çš„æŒ‡ä»¤`v-slot`çš„å€¼è·å–çš„ï¼Œæ‰€ä»¥å¯ä»¥ç¼©å†™æˆè¿™æ ·

```javascript
//çˆ¶ç»„ä»¶
<template>
  <div>
    <Child>
      <template #bigTurnip="bigTurnipProps">
        {{ bigTurnipProps.message }}
      </template>
    </Child>
  </div>
</template>
<script setup>
import Child from './Child.vue'
</script>

//å­ç»„ä»¶Child.vue

<template>
    <div>
        <!-- å¤§èåœ -->
        <div>
            <slot name="bigTurnip" message="æˆ‘æ˜¯èåŒ—"></slot>
        </div>
    </div>
</template>
```

è¿™ç±»æ’æ§½ä¾¿æ˜¯`å…·åä½œç”¨åŸŸæ’æ§½`å•¦

